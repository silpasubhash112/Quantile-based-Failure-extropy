(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17832,        431]
NotebookOptionsPosition[     17122,        410]
NotebookOutlinePosition[     17654,        429]
CellTagsIndexPosition[     17611,        426]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"samplesize", "=", 
   RowBox[{"{", "50", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"k", "=", 
  RowBox[{"Length", "[", "samplesize", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SeedRandom", "[", "999", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "<=", "k"}], ",", 
     RowBox[{"j", "=", 
      RowBox[{"j", "+", "1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", "=", "1000"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Q", "[", "u_", "]"}], ":=", 
       RowBox[{"\[Sigma]", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", "u"}], ")"}], "\[Lambda]"]}], ")"}], "/", 
           "\[Lambda]"}], ")"}], "\[Alpha]"]}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{"q", "[", "u_", "]"}], ":=", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Q", "[", "u", "]"}], ",", "u"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], "2"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["u", "2"], "*", " ", 
           RowBox[{"q", "[", "u", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dataMatrix", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"p", "=", "1"}], ",", 
        RowBox[{"p", "<=", "m"}], ",", 
        RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"samplesize", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"v", "=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", "n"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"data1", "=", 
          RowBox[{"Q", "/@", "v"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kk", "=", 
          RowBox[{"Sort", "[", "data1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"z1", "=", "kk"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"dataMatrix", ",", "z1"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", "z1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"cVector", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "<", "n"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"n", " ", 
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "-", "n"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", " ", "n"}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], " ", 
           RowBox[{
            RowBox[{"Binomial", "[", 
             RowBox[{"n", ",", "2"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}], " ", "*", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Binomial", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "-", 
                RowBox[{"Binomial", "[", 
                 RowBox[{
                  RowBox[{"n", "-", "i"}], ",", "1"}], "]"}]}], ")"}], " ", 
              RowBox[{"d", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"est", "[", "p", "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l1", "+", "l2", "-", 
             RowBox[{"d", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], ")"}], "/", "2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xiHat", "[", "p", "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"cVector", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"z1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"xiHatList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xiHat", "[", "p", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H111", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"est", "[", "p", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"or", "=", 
       RowBox[{"N", "[", "\[Xi]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mse", "[", "j", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "m"}], ")"}], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"H111", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "or"}], ")"}], "^", "2"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bias", "[", "j", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "m"}], ")"}], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"H111", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "or"}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"abias", "[", "j", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "m"}], ")"}], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"H111", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "or"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"varri", "[", "j", "]"}], "=", 
       RowBox[{"Variance", "[", "xiHatList", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"crlb", "[", "j", "]"}], "=", 
       RowBox[{"Variance", "[", "H111", "]"}]}], ";"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mses", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"biases", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"bias", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"abiases", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"abias", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"crlbs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"crlb", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tcrlbs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"varri", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"samplesize", "[", 
        RowBox[{"[", "aa", "]"}], "]"}], ",", 
       RowBox[{"mses", "[", 
        RowBox[{"[", "aa", "]"}], "]"}], ",", 
       RowBox[{"tcrlbs", "[", 
        RowBox[{"[", "aa", "]"}], "]"}], ",", 
       RowBox[{"crlbs", "[", 
        RowBox[{"[", "aa", "]"}], "]"}], ",", 
       RowBox[{"biases", "[", 
        RowBox[{"[", "aa", "]"}], "]"}], ",", 
       RowBox[{"abiases", "[", 
        RowBox[{"[", "aa", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aa", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<sim.xlsx\>\"", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Sample_size\>\"", ",", "\"\<MSE\>\"", ",", "\"\<ThCRLB\>\"", 
         ",", "\"\<CRLB\>\"", ",", "\"\<BIAS\>\"", ",", "\"\<ABIAS\>\""}], 
        "}"}], "}"}], ",", "t2"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<SimulatedDataMatrix.xlsx\>\"", ",", "dataMatrix"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SystemOpen", "[", "\"\<SimulatedDataMatrix.xlsx\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9149355372900133`*^9, 3.91493568979022*^9}, {
   3.9149358537383757`*^9, 3.914935890250945*^9}, {3.914935991134411*^9, 
   3.914935991668536*^9}, {3.9149360378672023`*^9, 3.9149360712292924`*^9}, {
   3.914936111653463*^9, 3.914936148281192*^9}, 3.914936187756083*^9, 
   3.914936296495865*^9, {3.9149371808472633`*^9, 3.9149371838637877`*^9}, {
   3.9149373415701103`*^9, 3.914937437417395*^9}, {3.914937786561988*^9, 
   3.914937791385167*^9}, {3.91493808158363*^9, 3.914938162511436*^9}, {
   3.9149381955291634`*^9, 3.914938210105485*^9}, 3.914938473052766*^9, {
   3.914938586575699*^9, 3.9149386898600435`*^9}, {3.9149387381483135`*^9, 
   3.9149387399748025`*^9}, {3.9149394227093496`*^9, 
   3.9149394637328844`*^9}, {3.914939495014662*^9, 3.9149395554742393`*^9}, {
   3.914939757482052*^9, 3.914939758527609*^9}, {3.914939808275911*^9, 
   3.914939839676259*^9}, {3.91493987757082*^9, 3.914939881185896*^9}, {
   3.914939938057627*^9, 3.9149399496358547`*^9}, {3.914939983048708*^9, 
   3.9149400373845615`*^9}, {3.9149400695344396`*^9, 3.914940119579943*^9}, {
   3.914940165099612*^9, 3.9149401659070654`*^9}, {3.914940239141349*^9, 
   3.9149402961203356`*^9}, {3.91494034617597*^9, 3.914940375688581*^9}, {
   3.9149404099608297`*^9, 3.914940544652447*^9}, {3.9149405875957327`*^9, 
   3.914940630205515*^9}, {3.914940829934664*^9, 3.9149409110055294`*^9}, {
   3.917842588533349*^9, 3.9178426349176908`*^9}, {3.917842692247197*^9, 
   3.9178429110917435`*^9}, 3.9178429682891064`*^9, {3.9178432692658925`*^9, 
   3.917843404737713*^9}, {3.9218128681946616`*^9, 3.9218128729900537`*^9}, {
   3.9218129578140736`*^9, 3.921812981539186*^9}, {3.9218132345816817`*^9, 
   3.921813256788048*^9}, {3.921813320621534*^9, 3.9218133215890493`*^9}, {
   3.9218133609837894`*^9, 3.921813371622675*^9}, {3.921813406118832*^9, 
   3.921813412060127*^9}, {3.921813472821394*^9, 3.921813476994115*^9}, {
   3.9218135677153687`*^9, 3.9218135731504183`*^9}, {3.9218179835672803`*^9, 
   3.9218179929098177`*^9}, {3.953943534245826*^9, 3.9539435543500566`*^9}, {
   3.9539437781302013`*^9, 3.9539437820253973`*^9}, {3.953944062853549*^9, 
   3.953944064753639*^9}, {3.953944242415862*^9, 3.9539442447620955`*^9}, {
   3.9586259261842494`*^9, 3.9586259612152843`*^9}, {3.958626530678445*^9, 
   3.9586265326624317`*^9}, {3.958626831466895*^9, 3.958626834340619*^9}, {
   3.9586271344762964`*^9, 3.9586271366669226`*^9}, {3.9598041401757298`*^9, 
   3.9598043089669313`*^9}, {3.9598044175812283`*^9, 3.959804418125059*^9}, {
   3.9598046814276276`*^9, 3.9598046819052277`*^9}, {3.9598049014182568`*^9, 
   3.959804919134234*^9}, {3.9598051185388765`*^9, 3.9598051243133516`*^9}, {
   3.959805699663025*^9, 3.959805715813717*^9}, {3.959805748476875*^9, 
   3.9598058060495234`*^9}, {3.9598058526766043`*^9, 
   3.9598058663682203`*^9}, {3.959805985505643*^9, 3.959806101983989*^9}, {
   3.959806174623987*^9, 3.959806174680603*^9}, 3.95980628131686*^9, {
   3.9598063555108194`*^9, 3.959806366952058*^9}, {3.959806501859538*^9, 
   3.959806502498245*^9}, {3.959807138111601*^9, 3.959807158201745*^9}, {
   3.9598072477528205`*^9, 3.9598072617897234`*^9}, {3.959807373660137*^9, 
   3.959807377149688*^9}, {3.9598074439864025`*^9, 3.9598075904585657`*^9}, {
   3.959807657038378*^9, 3.9598077073546705`*^9}, {3.9598080845858235`*^9, 
   3.959808089523518*^9}, {3.9598508568579044`*^9, 3.959850858459401*^9}, {
   3.9598509270640883`*^9, 3.959850929211873*^9}, {3.9598509802422733`*^9, 
   3.959850990011273*^9}, {3.9598510800729313`*^9, 3.9598510939690523`*^9}, {
   3.9598511468566875`*^9, 3.959851201807277*^9}, {3.9598513284545774`*^9, 
   3.959851662376746*^9}, {3.9598520904503984`*^9, 3.959852095959696*^9}, {
   3.95985229722782*^9, 3.9598523111763754`*^9}, {3.959852462771511*^9, 
   3.95985246572272*^9}, {3.959852550678944*^9, 3.959852554554355*^9}, {
   3.959852610068804*^9, 3.9598526476259537`*^9}, {3.9598527088907633`*^9, 
   3.959852709733522*^9}, {3.959852973445879*^9, 3.9598530010088215`*^9}, {
   3.95985307537304*^9, 3.9598531026073294`*^9}, {3.959856633181078*^9, 
   3.959856633997802*^9}, {3.95985667229009*^9, 3.959856694617812*^9}, {
   3.9598569813463173`*^9, 3.959857044695221*^9}, {3.959857175862356*^9, 
   3.959857212788848*^9}, {3.9598575777821913`*^9, 3.959857579844052*^9}, 
   3.9598578021811237`*^9, {3.959858248096735*^9, 3.959858298311474*^9}, {
   3.9598585477397027`*^9, 3.959858563877336*^9}, {3.9598589186654387`*^9, 
   3.9598589194620943`*^9}, {3.9599017856067667`*^9, 3.959901786006609*^9}, {
   3.9601704082014484`*^9, 3.96017043997355*^9}, {3.9607690623281918`*^9, 
   3.9607691157430415`*^9}, {3.9607691569047613`*^9, 
   3.9607691779223385`*^9}, {3.960769210972062*^9, 3.9607692617070932`*^9}, {
   3.960770279413824*^9, 3.960770284684569*^9}, {3.9607705445574064`*^9, 
   3.9607705576707363`*^9}, {3.960770848262204*^9, 3.9607708529448357`*^9}, 
   3.9607708853512807`*^9, 3.960771113636051*^9, {3.960771596282507*^9, 
   3.960771600155897*^9}, {3.9607716360371466`*^9, 3.9607716501095953`*^9}, {
   3.960773578872678*^9, 3.9607735814765625`*^9}, {3.9608065234426823`*^9, 
   3.9608065268536777`*^9}, {3.960807012895808*^9, 3.9608070554563475`*^9}, {
   3.9608072079147882`*^9, 3.960807265276372*^9}, 3.9608421265028305`*^9, {
   3.960842178754306*^9, 3.960842180299298*^9}, 3.960842577391951*^9, {
   3.960842692453288*^9, 
   3.9608426932762775`*^9}},ExpressionUUID->"38f7752f-fa78-4bb2-a67b-\
7cccbc6ea4ba"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.9607733789849997`*^9, 3.960773584520357*^9, 3.9608072869283094`*^9, 
   3.96084219034647*^9, {3.9608422373818474`*^9, 3.9608422461509895`*^9}, 
   3.960842583136543*^9, 3.960842642348356*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"a7235000-af54-4557-8825-21c0025a30b5"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9601765017389126`*^9, 
  3.9607692724692755`*^9},ExpressionUUID->"80fa7ffb-37ac-411e-b749-\
ded15d9d908a"]
},
WindowSize->{573., 568.8},
WindowMargins->{{Automatic, 250.80000000000007`}, {
  Automatic, 18.599999999999998`}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fbb8bb75-23de-4744-882c-ca1ea6da7d11"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 16043, 373, 1005, "Input",ExpressionUUID->"38f7752f-fa78-4bb2-a67b-7cccbc6ea4ba"],
Cell[16626, 397, 323, 5, 32, "Output",ExpressionUUID->"a7235000-af54-4557-8825-21c0025a30b5"]
}, Open  ]],
Cell[16964, 405, 154, 3, 28, "Input",ExpressionUUID->"80fa7ffb-37ac-411e-b749-ded15d9d908a"]
}
]
*)

